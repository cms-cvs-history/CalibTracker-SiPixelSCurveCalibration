process SCurveCalibration =  {
  
######################################################
#  define the number of events to run on (-1 = all)
######################################################

untracked PSet maxEvents = {untracked int32 input = -1}

#############################################
# Input source
#############################################

   include "IORawData/SiPixelInputSources/data/PixelSLinkDataInputSource.cfi"

#############################################
#   definition of the input file that contains the raw data
#   see https://twiki.cern.ch/twiki/bin/view/CMS/TIF_and_PSI_data 
#   for location of files
#############################################
   replace PixelSLinkDataInputSource.fileNames={'file:/FPixData/FPIX/HC+Z1/Runs_256_281_283_298/SCurve_283.dmp'}

   include "CalibTracker/SiPixelGainCalibration/data/fromRawSlinkData.cff"
   include "CalibTracker/SiPixelGainCalibration/data/SiPixelCalibDigiProducer.cfi"


############################################################
# cabling maps and geometry
############################################################
       
    # Pixel Cabling Map from DataBase
    include "CalibTracker/Configuration/data/SiPixel_TIFCabling.cff"
    include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"
    include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
    include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

############################################################
# include the settings for SiPixelSCurveCalibrationAnalysis.cfi
############################################################

include "CalibTracker/SiPixelSCurveCalibration/data/SiPixelSCurveCalibrationAnalysis.cfi"

############################################################
# location of histogram output
############################################################
replace siPixelSCurveAnalysis.outputFileName = "scurve_histograms.root"

replace CondDBCommon.connect = "sqlite_file:/afs/cern.ch/user/f/friis/scratch0/siPixelCalibConfiguration.db"

############################################################
# Database tag of calib.dat object
############################################################
es_source = PoolDBESSource {
     using CondDBCommon
     VPSet toGet = { { 
		     string record = "SiPixelCalibConfigurationRcd"
                     # your tag here
		     string tag = "HC-Z1_HD1_B01_02_03_SCurve_23Aug07_1851 "
		     } }
}

service = MessageLogger {
    untracked vstring destinations = { "output" }
                                     
    untracked vstring categories = { "SiPixelSCurveCalibration", "SiPixelOfflineCalibAnalysisBase" , "SiPixelSCurveCalibrationHistogramReport"}
    untracked PSet output = {
                untracked string threshold = "WARNING"
                untracked PSet FwkReport  = { untracked int32 reportEvery = 200 }
                untracked PSet SiPixelSCurveCalibration = { untracked int32 limit = 100 }
                untracked PSet SiPixelSCurveCalibrationHistogramReport = { untracked int32 limit = 1000 }
                untracked PSet SiPixelOfflineCalibAnalysisBase = { untracked int32 limit = 1000 }
    }
}


path p = {siPixelDigis, SiPixelCalibDigiProducer, filterEmptyCalibDigis, siPixelSCurveAnalysis} 

}

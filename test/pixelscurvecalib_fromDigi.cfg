process SCurveCalibration =  {

######################################################
#  define the number of events to run on (-1 = all)
######################################################

   untracked PSet maxEvents = {untracked int32 input = -1}
  
source = PoolSource 
{ 
     # replace 'myfile.root' with the source file you want to use
     # root file must contain SiPixelCalibDigis - DataFormats/SiPixelDigi/interface/SiPixelCalibDigi.h
     # See CalibTracker/SiPixelGainCalibration/test for producers
     untracked vstring fileNames = {"file:/home/friis/283timedCalibdigis.root"} 
}

############################################################
# include the settings for SiPixelSCurveCalibrationAnalysis.cfi
############################################################

include "CalibTracker/SiPixelSCurveCalibration/data/SiPixelSCurveCalibrationAnalysis.cfi"

############################################################
# location of histogram output
############################################################
replace siPixelSCurveAnalysis.outputFileName = "/home/friis/283scurve_histograms.root"

############################################################
# Logging options
############################################################

service = MessageLogger {
    untracked vstring destinations = { "output" }
                                     
    untracked vstring categories = { "SiPixelSCurveCalibration", "SiPixelOfflineCalibAnalysisBase" , "SiPixelSCurveCalibrationHistogramReport"}
    untracked PSet output = {
                untracked string threshold = "WARNING"
                untracked PSet FwkReport  = { untracked int32 reportEvery = 200 }
                untracked PSet SiPixelSCurveCalibration = { untracked int32 limit = 100 }
                untracked PSet SiPixelSCurveCalibrationHistogramReport = { untracked int32 limit = 1000 }
                untracked PSet SiPixelOfflineCalibAnalysisBase = { untracked int32 limit = 1000 }
    }
}

############################################################
# databases, cabling maps and geometry
############################################################

   include "CondTools/SiPixel/data/SiPixelCalibConfiguration.cfi"
   replace sipixelcalib_essource.toGet = { 
	{ 
	    string record = "SiPixelCalibConfigurationRcd"
	    # change the tag appropriately. 
	    # This tag string controls which calibration information is used and for now should match the used datafile.
	    string tag = "SCurve_283"
	},
	{ # this is cabling information, it contains the cabling map
	    string record = "SiPixelFedCablingMapRcd"
	    string tag = "SiPixelFedCablingMap_v9"
	}
    }

    include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"
    include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
    include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"
 
module filterEmptyCalibDigis = SiPixelCalibDigiFilter {}

service = DaqMonitorROOTBackEnd{}
      

path p = {siPixelSCurveAnalysis} 

}

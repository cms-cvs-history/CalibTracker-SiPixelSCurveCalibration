process PIXELSCURVECALIB =
{
   #PLEASE NOTE!!: Set the "PrintPixelHistos" flag below to true
   #if you wish to see scurves for all the pixels.
   #Occasionally, the ROOT cammand gStyle->SetOptFit() is needed
   #to view the results of the function fit.

######################################################
#  Read settings from the calibration database 
######################################################

   include "CondCore/DBCommon/data/CondDBCommon.cfi"
# name of the database 
   replace CondDBCommon.connect = "sqlite_file:/afs/cern.ch/cms/Tracker/Pixel/configuration/TestDatabase.db"
   replace CondDBCommon.timetype = "runnumber"
   replace CondDBCommon.DBParameters.messageLevel = 0
   replace CondDBCommon.DBParameters.authenticationPath="."
   es_source = PoolDBESSource {
	using CondDBCommon
	VPSet toGet = { { 
			string record = "SiPixelCalibConfigurationRcd"
			# change the tag appropriately. Look at /afs/cern.ch/cms/Tracker/Pixel/configuration/TestDatabase.txt for existing tag names.
			string tag = "HC-Z1_HD1_B01_02_03_SCurve_23Aug07_1851"
			} }
   }

#############################################

  # cabling
#  include "CondCore/DBCommon/data/CondDBCommon.cfi"
#  replace CondDBCommon.connect = "sqlite_file:cabling.db"
#  replace CondDBCommon.catalog = "file:cablingCatalog.xml"
#  replace CondDBCommon.timetype = "runnumber"
#  replace CondDBCommon.DBParameters.messageLevel = 1
#  replace CondDBCommon.DBParameters.authenticationPath="."
#  es_source = PoolDBESSource {
#    using CondDBCommon
#    VPSet toGet={{string record="SiPixelFedCablingMapRcd" string tag="SiPixelFedCablingMap_v8"}}
#  }

  # Pixel Cabling Map from DataBase
  include "CalibTracker/Configuration/data/SiPixel_TIFCabling.cff"


  # Tracker SimGeometryXML
    include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"

  # Tracker Geometry Builder
    include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"
 
  # Tracker Numbering Builder
    include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  untracked PSet maxEvents = {untracked int32 input = -1}

  service = AdaptorConfig{}

  source = PoolSource
  {
    untracked vstring fileNames = {'rfio:/castor/cern.ch/user/k/kellerjd/cmsfpix2_files/HC-Z1/HD2/Blades10_11_12/SCurve_08Aug07_1600_Blades10_11_12_digi.root'} 
    #untracked vstring fileNames = {"file:SCurve_pilot_BmO_D1-2_BLD8-9_FED39_digi.root"}
  }

  service = TFileService {string fileName = 'SCurve_08Aug07_1600_Blades10_11_12_scurve.root'}

  service = MessageLogger
  {
    #untracked vstring destinations = {"/afs/cern.ch/user/k/kellerjd/scratch0/CMSSW_2007-06-28/src/UserCode/kellerjd/test/scurve_debug.log"} 
    untracked vstring destinations = {"cout"}
    untracked PSet cout = {untracked string threshold = "DEBUG"}
  }

  include "CalibTracker/SiPixelSCurveCalibration/data/SiPixelSCurveCalibrationAnalysis.cfi"
  replace scurve.fedid = 34
  replace scurve.OutputTxtFile = "SCurve_08Aug07_1600_Blades10_11_12_scurve.txt"
  #replace scurve.PrintPixelHistos = true

  path p = {scurve}
}

